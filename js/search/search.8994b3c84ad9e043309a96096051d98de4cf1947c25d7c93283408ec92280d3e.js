(()=>{var y="/",L=20;(function(){let n=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function d(t){let s=document.querySelector("template").content,c=document.createDocumentFragment(),o=document.querySelector(".search-results");o.textContent="";for(let m in t){let r=t[m],u=s.cloneNode(!0),h=u.querySelector("a"),v=u.querySelector("time"),p=u.querySelector(".content");h.innerHTML=r.title,h.href=r.permalink,v.innerText=r.date,p.innerHTML=r.summary,c.appendChild(u)}o.appendChild(c)}function a(t){let s=t||document.querySelector(".search-text").value.trim(),c=n.search({query:s,enrich:!0,limit:L}),o={};c.forEach(function(m){m.result.forEach(function(r){o[r.doc.permalink]=r.doc})}),d(o)}function i(t){t.addEventListener("submit",function(s){s.preventDefault(),a()}),t.addEventListener("input",function(){a()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-bar").classList.remove("hidden"),document.querySelector(".search-text").focus()}function e(t){let s=y+"searchindex.json";document.querySelector(".search-loading").classList.remove("hidden"),fetch(s).then(function(c){return c.json()}).then(function(c){c.forEach(function(o){n.add(o)})}).then(t)}let l=document.querySelector(".search-form");l&&(e(function(){let t=new URLSearchParams(window.location.search).get("q");document.querySelector(".search-text").value=t||"",a(t)}),i(l))})();document.addEventListener("DOMContentLoaded",function(){let n=document.getElementById("search-drawer"),d=document.getElementById("search-drawer-button"),a=document.getElementById("search-drawer-overlay");a.addEventListener("click",i);function i(){let e=document.getElementById("search-drawer"),l=document.getElementById("search-drawer-overlay");e.classList.contains("open")?(e.classList.add("closing"),l.classList.remove("visible"),e.classList.remove("open"),setTimeout(()=>{e.classList.remove("closing"),e.classList.add("hidden")},300)):(e.classList.remove("hidden"),setTimeout(()=>{e.classList.add("open"),document.querySelector(".search-text").focus()},10))}d.addEventListener("click",i),document.addEventListener("keydown",function(e){e.ctrlKey&&e.key==="k"&&(e.preventDefault(),i())}),document.addEventListener("click",function(e){!n.contains(e.target)&&e.target!==d&&n.classList.contains("open")&&(n.classList.add("closing"),a.classList.remove("visible"),n.classList.remove("open"),setTimeout(()=>{n.classList.remove("closing"),n.classList.add("hidden"),n.style.transform=""},300))})});})();
