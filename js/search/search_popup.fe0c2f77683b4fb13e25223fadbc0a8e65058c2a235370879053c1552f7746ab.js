(()=>{var l="/",p=20;(function(){let u=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function h(e){let n=document.querySelector("template").content,t=document.createDocumentFragment(),o=document.querySelector(".search-popup-results");o.textContent="";for(let s in e){let c=e[s],r=n.cloneNode(!0),d=r.querySelector("a"),q=r.querySelector("time"),S=r.querySelector(".content");d.innerHTML=c.title,d.href=c.permalink,q.innerText=c.date,S.innerHTML=c.summary,t.appendChild(r)}o.appendChild(t)}function a(e){let n=e||document.getElementById("popupQuery").value.trim(),t=u.search({query:n,enrich:!0,limit:p}),o={};t.forEach(function(s){s.result.forEach(function(c){o[c.doc.permalink]=c.doc})}),h(o)}function f(e){e.addEventListener("submit",function(n){n.preventDefault(),a()}),e.addEventListener("input",function(){a()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-popup-bar").classList.remove("hidden"),document.getElementById("popupQuery").focus()}function y(e){let n=l+"searchindex.json";document.querySelector(".search-loading").classList.remove("hidden"),fetch(n).then(function(t){return t.json()}).then(function(t){t.forEach(function(o){u.add(o)})}).then(e)}let i=document.querySelector(".search-popup-form");i&&(y(function(){let e=new URLSearchParams(window.location.search).get("q");document.getElementById("popupQuery").value=e||"",a(e)}),f(i))})();})();
