<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Redis - ZSet | ch.hugo</title>
<link rel=icon href=favicon.svg sizes=any type=image/svg+xml><meta property="og:url" content="https://chhz0.github.io/notes/database/redis/datatypes/zset/"><meta property="og:site_name" content="ch.hugo"><meta property="og:title" content="Redis - ZSet"><meta property="og:description" content="Redis< ZSet > Redis ZSet 是一个关联分数排序的唯一字符串集合. 当多个字符串具有相同分数时，字符串会按照字典顺序排列。
ZSet可以适用于:
排行榜. 使用ZSet维护大型游戏中最高分数的有序列表. 速率限制器. 使用ZSet构建滑动窗口速率限制器，以防止过多的API请求. ZSet可以视为是集合和哈希的混合，一方面，其与集合类似，由唯一的、不重复的字符串元素组成；另一方面，集合内元素没有排序，但是排序集合中每个元素都和一个浮点值相关联，也就是类似于哈希，每个元素映射一个值
此外，排序集中的元素是按顺序获取的，这个顺序遵守以下规则：
如果 B 和 A 是具有不同分数的两个元素，则如果 A.score 是 > B.score，则 A > B. 如果 B 和 A 的分数完全相同，则如果 A 字符串按字典顺序大于 B 字符串，则 A > B。 B 和 A 字符串不能相等，因为排序集仅具有唯一元素 ZSet 命令 ZSet常见命令：
创建：ZADD ZADD key score member [score member] # 向Sorted Set增加数据，如果key已经存在的Key，则更新对应的数据 扩展参数：XX, NX, LT, GT 查询：ZRANGE, ZCOUNT, ZRANK, ZCARD, ZSCORE ZCARD key # 查看ZSet中的成员 ZRANGE key start stop [WITHSCORES] # 查询从start到stop范围的ZSet数据，WITHSCORES选填，不写输出里只有key，没有score值 ZREVRANGE key start stop [WITHSCORES] # 即reverse range，从大到小遍历，WITHSCORES选项，不写不会输出score ZCOUNT key min max # 计算min-max积分范围的成员 ZRANK key member # 查看ZSet中member的排名索引，索引从0开始，所以排名是第一，索引就是0 ZSCORE key member # 查询ZSet成员的分数 更新：ZADD, ZREM ZREM key member [member ...] # 删除ZSet中的元素 删除：DEL, UNLINK ::: tip 详细ZSet命令 🔗 ZSets命令列表 :::"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2025-06-10T22:36:08+08:00"><meta property="article:modified_time" content="2025-06-10T22:36:08+08:00"><meta property="article:tag" content="Redis"><meta name=twitter:card content="summary"><meta name=twitter:title content="Redis - ZSet"><meta name=twitter:description content="Redis< ZSet > Redis ZSet 是一个关联分数排序的唯一字符串集合. 当多个字符串具有相同分数时，字符串会按照字典顺序排列。
ZSet可以适用于:
排行榜. 使用ZSet维护大型游戏中最高分数的有序列表. 速率限制器. 使用ZSet构建滑动窗口速率限制器，以防止过多的API请求. ZSet可以视为是集合和哈希的混合，一方面，其与集合类似，由唯一的、不重复的字符串元素组成；另一方面，集合内元素没有排序，但是排序集合中每个元素都和一个浮点值相关联，也就是类似于哈希，每个元素映射一个值
此外，排序集中的元素是按顺序获取的，这个顺序遵守以下规则：
如果 B 和 A 是具有不同分数的两个元素，则如果 A.score 是 > B.score，则 A > B. 如果 B 和 A 的分数完全相同，则如果 A 字符串按字典顺序大于 B 字符串，则 A > B。 B 和 A 字符串不能相等，因为排序集仅具有唯一元素 ZSet 命令 ZSet常见命令：
创建：ZADD ZADD key score member [score member] # 向Sorted Set增加数据，如果key已经存在的Key，则更新对应的数据 扩展参数：XX, NX, LT, GT 查询：ZRANGE, ZCOUNT, ZRANK, ZCARD, ZSCORE ZCARD key # 查看ZSet中的成员 ZRANGE key start stop [WITHSCORES] # 查询从start到stop范围的ZSet数据，WITHSCORES选填，不写输出里只有key，没有score值 ZREVRANGE key start stop [WITHSCORES] # 即reverse range，从大到小遍历，WITHSCORES选项，不写不会输出score ZCOUNT key min max # 计算min-max积分范围的成员 ZRANK key member # 查看ZSet中member的排名索引，索引从0开始，所以排名是第一，索引就是0 ZSCORE key member # 查询ZSet成员的分数 更新：ZADD, ZREM ZREM key member [member ...] # 删除ZSet中的元素 删除：DEL, UNLINK ::: tip 详细ZSet命令 🔗 ZSets命令列表 :::"><link rel=stylesheet href=/css/components.min.9d886688d3ae94cecf1b057e706bf74497fcd5cea352d433c34cda3b9425a8d4.css integrity="sha256-nYhmiNOulM7PGwV+cGv3RJf81c6jUtQzw0zaO5QlqNQ=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.17813e97a146cc70fc6064666a89082f1ef2f6213c7d3fade88402a86cf8aa3c.css integrity="sha256-F4E+l6FGzHD8YGRmaokILx7y9iE8fT+t6IQCqGz4qjw=" crossorigin=anonymous><link rel=stylesheet href=/css/root.min.1677bc99f2421f7cb9fc1d00b09addcc951fd9d4c785e22b20ed55c0602786fc.css integrity="sha256-Fne8mfJCH3y5/B0AsJrdzJUf2dTHheIrIO1VwGAnhvw=" crossorigin=anonymous><link rel=stylesheet href=/css/search.min.cb1ed1dad3ee872e229e9f1fc681bdbd20d923389f1fa6aaf89f9aee93af4fbf.css integrity="sha256-yx7R2tPuhy4inp8fxoG9vSDZIzifH6aq+J+a7pOvT78=" crossorigin=anonymous><link rel=stylesheet href=/css/bundle.min.4878d16c866148ae8cfd6f4f44052d25f2548b24ab4a9bc857279dc6d06df2b5.css integrity="sha256-SHjRbIZhSK6M/W9PRAUtJfJUiySrSpvIVyedxtBt8rU=" crossorigin=anonymous><script src=/js/bundle.995e4ec99401021e081ec256bee66154ef7f4e5136809432513b2e6d014b4b1d.js integrity="sha256-mV5OyZQBAh4IHsJWvuZhVO9/TlE2gJQyUTsubQFLSx0=" crossorigin=anonymous></script><script defer src=/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js integrity="sha256-ZFlLEl97eL30+oMWlVkiu+uxzWuu8/FmVL/KIDCfGPg="></script><script defer src=/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js integrity="sha256-HZgPhN8R8+t8jF8X9UHUmgYRYI3xed10+n8GIl61as4="></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet></head><body class=notransition><div id=container><header id=main-header><div role=navigation aria-label=Main><div class=nav-left><a href=https://chhz0.github.io/ style=color:inherit>ch.hugo</a></div><div class=nav-right><div style=position:absolute;width:0;height:0><div id=nav-dropdown-menu class=hidden href=#><div class=nav-item><a href=/blogs/>博客</a></div><div class=nav-item><a aria-current=true class=ancestor href=/notes/>笔记</a></div><div class=nav-item><a href=/about/>关于</a></div></div></div><a id=nav-dropdown-button href=#><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div id=nav-menu><div class=nav-item><a href=/blogs/>博客</a></div><div class=nav-item><a aria-current=true class=ancestor href=/notes/>笔记</a></div><div class=nav-item><a href=/about/>关于</a></div></div><a id=theme-switcher href=#><svg class="light-icon" viewBox="0 0 24 24" fill="none"><path d="M12 3V4m0 16v1M4 12H3M6.31412 6.31412 5.5 5.5m12.1859.81412L18.5 5.5M6.31412 17.69 5.5 18.5001M17.6859 17.69 18.5 18.5001M21 12H20m-4 0c0 2.2091-1.7909 4-4 4-2.20914.0-4-1.7909-4-4 0-2.20914 1.79086-4 4-4 2.2091.0 4 1.79086 4 4z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
<svg class="dark-icon" viewBox="0 0 24 24" fill="none"><path d="M3.32031 11.6835c0 4.9706 4.02944 9 8.99999 9 3.7872.0 7.028-2.3392 8.3565-5.6515C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834c-4.9706.0-8.99999-4.0294-8.99999-8.99998C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996 5.65605 4.66028 3.32031 7.89912 3.32031 11.6835z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</a>|
<a id=theme-switcher href=https://github.com/chhz0 aria-label=GitHub><svg class="light-icon" width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#fff"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg><svg class="dark-icon" width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></div></div></header><div class="flex grow"><div id=main-pane><main id=main-content><div class=single-header><ol class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/><span itemprop=name>Home</span>
</a><meta itemprop=position content='1'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/><span itemprop=name>Notes</span>
</a><meta itemprop=position content='2'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/database/><span itemprop=name>Database</span>
</a><meta itemprop=position content='3'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/database/redis/><span itemprop=name>Redis</span>
</a><meta itemprop=position content='4'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/database/redis/datatypes/><span itemprop=name>Redis - Datatypes</span>
</a><meta itemprop=position content='5'></li><span>&nbsp»&nbsp</span></ol><h1>Redis - ZSet</h1><time class=dim datetime=2025-06-10T22:36:08+08:00>June 10, 2025</time><div class=term-container><div class=tag><a href=https://chhz0.github.io/tags/redis/>#Redis</a></div></ol></div><section class=page-section><h2 id=redis-zset->Redis&lt; ZSet ></h2><p>Redis ZSet 是一个关联分数排序的唯一字符串集合. 当多个字符串具有相同分数时，字符串会按照字典顺序排列。</p><p><code>ZSet</code>可以适用于:</p><ul><li>排行榜. 使用ZSet维护大型游戏中最高分数的有序列表.</li><li>速率限制器. 使用ZSet构建滑动窗口速率限制器，以防止过多的API请求.</li></ul><p><code>ZSet</code>可以视为是集合和哈希的混合，一方面，其与集合类似，由唯一的、不重复的字符串元素组成；另一方面，集合内元素没有排序，但是排序集合中每个元素都和一个浮点值相关联，也就是类似于哈希，每个元素映射一个值</p><p>此外，排序集中的元素是按顺序获取的，这个顺序遵守以下规则：</p><ol><li>如果 B 和 A 是具有不同分数的两个元素，则如果 A.score 是 > B.score，则 A > B.</li><li>如果 B 和 A 的分数完全相同，则如果 A 字符串按字典顺序大于 B 字符串，则 A > B。 B 和 A 字符串不能相等，因为排序集仅具有唯一元素</li></ol><h3 id=zset-命令>ZSet 命令</h3><p>ZSet常见命令：</p><ul><li>创建：<code>ZADD</code><ul><li><code>ZADD key score member [score member]</code> # 向Sorted Set增加数据，如果key已经存在的Key，则更新对应的数据<ul><li>扩展参数：XX, NX, LT, GT</li></ul></li></ul></li><li>查询：<code>ZRANGE</code>, <code>ZCOUNT</code>, <code>ZRANK</code>, <code>ZCARD</code>, <code>ZSCORE</code><ul><li><code>ZCARD key</code> # 查看ZSet中的成员</li><li><code>ZRANGE key start stop [WITHSCORES]</code> # 查询从start到stop范围的ZSet数据，WITHSCORES选填，不写输出里只有key，没有score值</li><li><code>ZREVRANGE key start stop [WITHSCORES]</code> # 即reverse range，从大到小遍历，WITHSCORES选项，不写不会输出score</li><li><code>ZCOUNT key min max</code> # 计算min-max积分范围的成员</li><li><code>ZRANK key member</code> # 查看ZSet中member的排名索引，索引从0开始，所以排名是第一，索引就是0</li><li><code>ZSCORE key member</code> # 查询ZSet成员的分数</li></ul></li><li>更新：<code>ZADD</code>, <code>ZREM</code><ul><li><code>ZREM key member [member ...]</code> # 删除ZSet中的元素</li></ul></li><li>删除：<code>DEL</code>, <code>UNLINK</code></li></ul><p>::: tip 详细ZSet命令
🔗 <a href="https://redis.io/docs/latest/commands/?group=sorted-set">ZSets命令列表</a>
:::</p><h3 id=zset-编码底层实现>ZSet 编码(底层实现)</h3><p>ZSet底层编码有两种：<code>ZIPLIST</code>， <code>SKIPLIST</code>+<code>HASHTABLE</code></p><ul><li><code>ZIPLIST</code><ul><li>列表对象保存的所有字符串对象长度都小于64字节，且列表对象元素个数少于128个</li><li>使用<code>ZIPLIST</code>的目的是在数据量小的时候节省内存，在紧凑的结构中以<code>value</code>+<code>score</code>的形式存放进<code>ziplist.entry</code></li></ul></li></ul><p>当上述条件不符合的时候，编码使用<code>SKIPLIST</code>+<code>HASHTABLE</code></p><p>SKIPLIST是一种可以快速查找的多级链表结构，通过SKIPLIST可以快速定位到数据所在，它的排名操作、范围查询性能都很高</p><blockquote><p>🔗 <a href=/notes/database/redis/datatypes/encoding/ziplist/>查看SKIPLIST编码</a></p></blockquote></section></main><footer id=main-footer><div class=footer><a href=#>回到顶部 ↑</a><div class=footer-copyright><div>© 2025 Chen-Hang</div><div>powered by <a href=https://github.com/math-queiroz/rusty-typewriter target=_blank>Rusty Typewriter</a> theme for <a href=https://gohugo.io/ target=_blank>Hugo</a></div></div></div></footer></div><aside id=side-pane class=side-sticky><div class=side-details><span>691 字数</span>
<span>2 - 3 阅读时间</span><div class=side-details-taxonomy><small>categories:
<span class=details-taxonomy><a href=https://chhz0.github.io/categories/note>Note</a></span></small></div></div><h3>目录</h3><nav id=TableOfContents><ul><li><a href=#redis-zset->Redis&lt; ZSet ></a><ul><li><a href=#zset-命令>ZSet 命令</a></li><li><a href=#zset-编码底层实现>ZSet 编码(底层实现)</a></li></ul></li></ul></nav><h3>相关</h3><ul><li><a href=/notes/database/redis/datatypes/encoding/hashtable/>Redis - Encoding&lt;HashTable></a></li><li><a href=/notes/database/redis/datatypes/encoding/skiplist/>Redis - Encoding&lt;SkipList></a></li><li><a href=/notes/database/redis/datatypes/encoding/ziplist/>Redis - Encoding&lt;ZipList></a></li><li><a href=/notes/database/redis/datatypes/encoding/sds/>Redis - Encoding&lt;sds></a></li><li><a href=/notes/database/redis/datatypes/hash/>Redis - Hash</a></li></ul></aside></div></div></body></html>