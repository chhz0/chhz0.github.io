<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mysql Transaction(bate) | ch.hugo</title>
<link rel=icon href=favicon.svg sizes=any type=image/svg+xml><meta property="og:url" content="https://chhz0.github.io/notes/database/mysql/mysql-transaction/"><meta property="og:site_name" content="ch.hugo"><meta property="og:title" content="Mysql Transaction(bate)"><meta property="og:description" content="MySQL 事务
1.事务有哪些特征 原子性，隔离性，一致性，持久性
原子性：要么全做，要么全不做
隔离性：保证其它的状态转换不会影响到本次状态的转
一致性：数据全部符合现实世界的约束
持久性： 更新后的数据存储到磁盘
InnoDB引擎通过以下技术来保证事务的四个特性
持久性是通过 redo log（重做日志）来保证
原子性是通过 undo log（回滚日志）来保证
隔离性是通过 mvcc（多版本并发控制）或者锁机制来保证
一致性是通过持久性+原子性+隔离性来保证
2.并发事务会引发的问题 MySQL服务端是允许多个客户端连接，这意味着MySQL会出现同时处理多个事务的情况
在同时处理多个事务的时候，可能会出现脏读、不可重复读、幻读的问题
脏读：一个事务读到了另一个未提交事务修改过的数据
不可重复读：在一个事务中多次读取同一个数据，出现前后两次读到的数据不一样的情况
幻读：在一个事务中多次查询某个符合查询条件的记录数量，如果出现前后两次查询到的记录数据不一样的情况
以上三个现象，问题的严重性是 脏读 > 不可重复读 > 幻读
3.事务的隔离级别 四种隔离级别：
读未提交：指一个事务还没有提交时，它做的变更就能被其他事务看到
读提交：指一个事务提交之后，它做的变更才能被其他事务看到
可重复读：指一个事务执行过程中看到的数据，一直跟这个事务启动时看到的数据是一致的，MySQL InnoDB引擎的默认隔离级别
串行化：对记录加上读写锁，在多个事务对这条记录进行读写操作时，如果发生读写冲突的时候，后访问的事务必须等前一个事务执行完成
按隔离水平高低排序如下：
串行化 > 可重复读 > 读已提交 > 读未提交
针对不同的隔离级别：并发事务时可能发生的现象也不同
读未提交：脏读、不可重复读、幻读
读提交：不可重复读、幻读
可重复读：幻读
串行化：
可重复读的隔离级别下，可以很大程度上避免幻读现象的发生，所以MySQL不使用串行化隔离级别来避免幻读现象的发生，因为串行化隔离级别会影响性能
InnoDB在默认隔离级别：可重复读的情况下很大程度上解决幻读现象的解决方案有两种：
针对**快照读（普通 select 语句），**是通过MVCC方式解决幻读
针对**当前读（select … for update），**通过next-key lock（记录锁+间隙锁）方式解决了幻读
四种隔离事务是怎么实现的
对于读未提交：可以读到未提交事务修改的数据，所以直接读取就行
对于串行化，通过加读写锁的方式来避免并行访问
对于读提交和可重复读这两种隔离级别的事务，是通过Read View来实现的，它们的区别是在于创建Read View时，读提交隔离级别是在每个语句执行之前都会重新生成一个Read View；而可重复读隔离级别是启动事务时生成一个Read View，然后整个事务都在用这个Read View"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2025-07-03T23:16:28+08:00"><meta property="article:modified_time" content="2025-07-03T23:16:28+08:00"><meta property="article:tag" content="MySQL"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mysql Transaction(bate)"><meta name=twitter:description content="MySQL 事务
1.事务有哪些特征 原子性，隔离性，一致性，持久性
原子性：要么全做，要么全不做
隔离性：保证其它的状态转换不会影响到本次状态的转
一致性：数据全部符合现实世界的约束
持久性： 更新后的数据存储到磁盘
InnoDB引擎通过以下技术来保证事务的四个特性
持久性是通过 redo log（重做日志）来保证
原子性是通过 undo log（回滚日志）来保证
隔离性是通过 mvcc（多版本并发控制）或者锁机制来保证
一致性是通过持久性+原子性+隔离性来保证
2.并发事务会引发的问题 MySQL服务端是允许多个客户端连接，这意味着MySQL会出现同时处理多个事务的情况
在同时处理多个事务的时候，可能会出现脏读、不可重复读、幻读的问题
脏读：一个事务读到了另一个未提交事务修改过的数据
不可重复读：在一个事务中多次读取同一个数据，出现前后两次读到的数据不一样的情况
幻读：在一个事务中多次查询某个符合查询条件的记录数量，如果出现前后两次查询到的记录数据不一样的情况
以上三个现象，问题的严重性是 脏读 > 不可重复读 > 幻读
3.事务的隔离级别 四种隔离级别：
读未提交：指一个事务还没有提交时，它做的变更就能被其他事务看到
读提交：指一个事务提交之后，它做的变更才能被其他事务看到
可重复读：指一个事务执行过程中看到的数据，一直跟这个事务启动时看到的数据是一致的，MySQL InnoDB引擎的默认隔离级别
串行化：对记录加上读写锁，在多个事务对这条记录进行读写操作时，如果发生读写冲突的时候，后访问的事务必须等前一个事务执行完成
按隔离水平高低排序如下：
串行化 > 可重复读 > 读已提交 > 读未提交
针对不同的隔离级别：并发事务时可能发生的现象也不同
读未提交：脏读、不可重复读、幻读
读提交：不可重复读、幻读
可重复读：幻读
串行化：
可重复读的隔离级别下，可以很大程度上避免幻读现象的发生，所以MySQL不使用串行化隔离级别来避免幻读现象的发生，因为串行化隔离级别会影响性能
InnoDB在默认隔离级别：可重复读的情况下很大程度上解决幻读现象的解决方案有两种：
针对**快照读（普通 select 语句），**是通过MVCC方式解决幻读
针对**当前读（select … for update），**通过next-key lock（记录锁+间隙锁）方式解决了幻读
四种隔离事务是怎么实现的
对于读未提交：可以读到未提交事务修改的数据，所以直接读取就行
对于串行化，通过加读写锁的方式来避免并行访问
对于读提交和可重复读这两种隔离级别的事务，是通过Read View来实现的，它们的区别是在于创建Read View时，读提交隔离级别是在每个语句执行之前都会重新生成一个Read View；而可重复读隔离级别是启动事务时生成一个Read View，然后整个事务都在用这个Read View"><link rel=stylesheet href=/css/components.min.9d886688d3ae94cecf1b057e706bf74497fcd5cea352d433c34cda3b9425a8d4.css integrity="sha256-nYhmiNOulM7PGwV+cGv3RJf81c6jUtQzw0zaO5QlqNQ=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.17813e97a146cc70fc6064666a89082f1ef2f6213c7d3fade88402a86cf8aa3c.css integrity="sha256-F4E+l6FGzHD8YGRmaokILx7y9iE8fT+t6IQCqGz4qjw=" crossorigin=anonymous><link rel=stylesheet href=/css/root.min.1677bc99f2421f7cb9fc1d00b09addcc951fd9d4c785e22b20ed55c0602786fc.css integrity="sha256-Fne8mfJCH3y5/B0AsJrdzJUf2dTHheIrIO1VwGAnhvw=" crossorigin=anonymous><link rel=stylesheet href=/css/search.min.cb1ed1dad3ee872e229e9f1fc681bdbd20d923389f1fa6aaf89f9aee93af4fbf.css integrity="sha256-yx7R2tPuhy4inp8fxoG9vSDZIzifH6aq+J+a7pOvT78=" crossorigin=anonymous><link rel=stylesheet href=/css/bundle.min.4878d16c866148ae8cfd6f4f44052d25f2548b24ab4a9bc857279dc6d06df2b5.css integrity="sha256-SHjRbIZhSK6M/W9PRAUtJfJUiySrSpvIVyedxtBt8rU=" crossorigin=anonymous><script src=/js/bundle.995e4ec99401021e081ec256bee66154ef7f4e5136809432513b2e6d014b4b1d.js integrity="sha256-mV5OyZQBAh4IHsJWvuZhVO9/TlE2gJQyUTsubQFLSx0=" crossorigin=anonymous></script><script defer src=/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js integrity="sha256-ZFlLEl97eL30+oMWlVkiu+uxzWuu8/FmVL/KIDCfGPg="></script><script defer src=/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js integrity="sha256-HZgPhN8R8+t8jF8X9UHUmgYRYI3xed10+n8GIl61as4="></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet></head><body class=notransition><div id=container><header id=main-header><div role=navigation aria-label=Main><div class=nav-left><a href=https://chhz0.github.io/ style=color:inherit>ch.hugo</a></div><div class=nav-right><div style=position:absolute;width:0;height:0><div id=nav-dropdown-menu class=hidden href=#><div class=nav-item><a href=/blogs/>博客</a></div><div class=nav-item><a aria-current=true class=ancestor href=/notes/>笔记</a></div><div class=nav-item><a href=/about/>关于</a></div></div></div><a id=nav-dropdown-button href=#><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div id=nav-menu><div class=nav-item><a href=/blogs/>博客</a></div><div class=nav-item><a aria-current=true class=ancestor href=/notes/>笔记</a></div><div class=nav-item><a href=/about/>关于</a></div></div><a id=theme-switcher href=#><svg class="light-icon" viewBox="0 0 24 24" fill="none"><path d="M12 3V4m0 16v1M4 12H3M6.31412 6.31412 5.5 5.5m12.1859.81412L18.5 5.5M6.31412 17.69 5.5 18.5001M17.6859 17.69 18.5 18.5001M21 12H20m-4 0c0 2.2091-1.7909 4-4 4-2.20914.0-4-1.7909-4-4 0-2.20914 1.79086-4 4-4 2.2091.0 4 1.79086 4 4z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
<svg class="dark-icon" viewBox="0 0 24 24" fill="none"><path d="M3.32031 11.6835c0 4.9706 4.02944 9 8.99999 9 3.7872.0 7.028-2.3392 8.3565-5.6515C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834c-4.9706.0-8.99999-4.0294-8.99999-8.99998C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996 5.65605 4.66028 3.32031 7.89912 3.32031 11.6835z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</a>|
<a id=theme-switcher href=https://github.com/chhz0 aria-label=GitHub><svg class="light-icon" width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#fff"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg><svg class="dark-icon" width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></div></div></header><div class="flex grow"><div id=main-pane><main id=main-content><div class=single-header><ol class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/><span itemprop=name>Home</span>
</a><meta itemprop=position content='1'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/><span itemprop=name>Notes</span>
</a><meta itemprop=position content='2'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/database/><span itemprop=name>Database</span>
</a><meta itemprop=position content='3'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://chhz0.github.io/notes/database/mysql/><span itemprop=name>MySQL</span>
</a><meta itemprop=position content='4'></li><span>&nbsp»&nbsp</span></ol><h1>Mysql Transaction(bate)</h1><time class=dim datetime=2025-07-03T23:16:28+08:00>July 3, 2025</time><div class=term-container><div class=tag><a href=https://chhz0.github.io/tags/mysql/>#MySQL</a></div></ol></div><section class=page-section><blockquote><p>MySQL 事务</p></blockquote><h2 id=1事务有哪些特征>1.事务有哪些特征</h2><p>原子性，隔离性，一致性，持久性</p><ul><li><p>原子性：要么全做，要么全不做</p></li><li><p>隔离性：保证其它的状态转换不会影响到本次状态的转</p></li><li><p>一致性：数据全部符合现实世界的约束</p></li><li><p>持久性： 更新后的数据存储到磁盘</p></li></ul><p>InnoDB引擎通过以下技术来保证事务的四个特性</p><ol><li><p>持久性是通过 redo log（重做日志）来保证</p></li><li><p>原子性是通过 undo log（回滚日志）来保证</p></li><li><p>隔离性是通过 mvcc（多版本并发控制）或者锁机制来保证</p></li><li><p>一致性是通过持久性+原子性+隔离性来保证</p></li></ol><h2 id=2并发事务会引发的问题>2.并发事务会引发的问题</h2><p>MySQL服务端是允许多个客户端连接，这意味着MySQL会出现同时处理多个事务的情况</p><p>在同时处理多个事务的时候，可能会出现脏读、不可重复读、幻读的问题</p><ul><li><p>脏读：一个事务读到了另一个<strong>未提交事务修改过</strong>的数据</p></li><li><p>不可重复读：在一个事务中多次读取同一个<strong>数据</strong>，出现前后两次读到的数据不一样的情况</p></li><li><p>幻读：在一个事务中多次查询某个符合查询条件的<strong>记录数量</strong>，如果出现前后两次查询到的记录数据不一样的情况</p></li></ul><p>以上三个现象，问题的严重性是 脏读 > 不可重复读 > 幻读</p><h2 id=3事务的隔离级别>3.事务的隔离级别</h2><p>四种隔离级别：</p><ol><li><p>读未提交：指一个事务还没有提交时，它做的变更就能被其他事务看到</p></li><li><p>读提交：指一个事务提交之后，它做的变更才能被其他事务看到</p></li><li><p>可重复读：指一个事务执行过程中看到的数据，一直跟这个事务启动时看到的数据是一致的，<strong>MySQL</strong> <strong>InnoDB引擎的默认隔离级别</strong></p></li><li><p>串行化：对记录加上读写锁，在多个事务对这条记录进行读写操作时，如果发生读写冲突的时候，后访问的事务必须等前一个事务执行完成</p></li></ol><blockquote><p>按隔离水平高低排序如下：</p><p>串行化 > 可重复读 > 读已提交 > 读未提交</p></blockquote><p>针对不同的隔离级别：并发事务时可能发生的现象也不同</p><ul><li><p>读未提交：脏读、不可重复读、幻读</p></li><li><p>读提交：不可重复读、幻读</p></li><li><p>可重复读：幻读</p></li><li><p>串行化：</p></li></ul><p>可重复读的隔离级别下，可以<strong>很大程度上避免</strong>幻读现象的发生，所以MySQL不使用串行化隔离级别来避免幻读现象的发生，因为<strong>串行化隔离级别会影响性能</strong></p><p>InnoDB在默认隔离级别：<strong>可重复读</strong>的情况下很大程度上解决幻读现象的解决方案有两种：</p><ul><li><p>针对**快照读（普通 select 语句），**是通过MVCC方式解决幻读</p></li><li><p>针对**当前读（select &mldr; for update），**通过next-key lock（记录锁+间隙锁）方式解决了幻读</p></li></ul><p>四种隔离事务是怎么实现的</p><ul><li><p>对于读未提交：可以读到未提交事务修改的数据，所以直接读取就行</p></li><li><p>对于串行化，通过加读写锁的方式来避免并行访问</p></li><li><p>对于读提交和可重复读这两种隔离级别的事务，是通过Read View来实现的，它们的区别是在于创建Read View时，读提交隔离级别是在每个语句执行之前都会重新生成一个Read View；而可重复读隔离级别是启动事务时生成一个Read View，然后整个事务都在用这个Read View</p></li></ul><p>在执行开启事务命令，并不意味着启动了事务：</p><p>在MySQL中，开启事务有两种命令，分别是：</p><ul><li><p><code>begin/start transaction</code>，执行命令后，并不意味着事务启动，只有执行了第一条select语句，才是事务真正启动的时机</p></li><li><p><code>start transaction with consistent snapshot</code>，马上启动事务</p></li></ul><h2 id=read-view在mvcc中是如何工作的>Read View在MVCC中是如何工作的？</h2><p>Read View的四个字段</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Plain data-lang=Plain><span style=display:flex><span>&lt;creator_trx_id&gt; &lt;m_ids&gt; &lt;min_trx_id&gt; &lt;max_trx_id&gt;
</span></span></code></pre></div><ul><li><p><code>creator_trx_id</code>:创建该Read View的事务的事务id</p></li><li><p><code>m_ids</code>:指创建Read View时，当前数据库中活跃事务的事务id列表</p></li><li><p><code>min_trx_id</code>:生成ReadView时系统中活跃的事务中最小的事务id，即<code>m_ids</code>中的最小的事务id，也是表示活跃的事务最早的那个</p></li><li><p><code>max_trx_id</code>:表示生成ReadView时系统中应该分配给下一个事务的id值</p></li></ul><p>这里还需要了解聚簇索引记录中的两个隐藏列，<code>trx_id</code>和<code>roll_pointer</code></p><ul><li><p><code>trx_id</code>，当一个事务对某条聚簇索引进行改动时，会把该事务的事务id记录在<code>trx_id</code>隐藏列中</p></li><li><p><code>roll_pointer</code>，这个隐藏列是指针，指向每一个旧版本记录</p></li></ul><p>有了ReadView，以及undo log，在访问某条记录的时，按照以下步骤进行判断：</p><ol><li><p><code>trx_id</code> == <code>creator_trx_id</code> ，意味着当前事务在访问自己修改过的记录，可以访问</p></li><li><p><code>trx_id</code> &lt; <code>min_trx_id</code> ，表明生成该版本的事务在当前事务生成Read View前已经提交，可以访问</p></li><li><p><code>trx_id</code> > <code>max_trx_id</code> ，表明生成该版本的事务在当前事务生成Read View后才开启，不可以访问</p></li><li><p><code>min_trx_id</code> &lt; <code>trx_id</code> &lt; <code>max_trx_ix</code> ，还需要再进一步判断</p><ol><li><p><code>trx_id</code> 存在 <code>m_ids</code> 中，说明创建Read View时生成该版本的事务还是活跃的，不可以访问</p></li><li><p><code>trx_id</code> 不在 <code>m_ids</code> 中，说明创建Read View时生成该版本的事务已经提交了，可以访问</p></li></ol></li></ol><blockquote><p>Read COMMITTD、REPETABLE READ这两种隔离级别的一个很大不同：生成ReadView的时机不同，REAED COMMITTD在每一次进行普通select操作前都会生成一个ReadView，而REPEATABLE READ只在第一次进行普通SELECT操作前生成一个ReadView，之后的查询操作都重复使用这个ReadView，不会再生成一个新的ReadView</p></blockquote><p>这种通过「版本链」来控制并发事务访问同一个记录时的行为就叫 MVCC（多版本并发控制）。</p><h2 id=可重复读是如何工作的>可重复读是如何工作的？</h2><p>可重复读隔离级别是启动事务时生成一个Read View，然后整个事务期间都在用这个Read View</p><p>如果某个事物开启后，去读取记录，发现记录的<code>trx_id</code> 比自己事物id小且在活跃的事物id列表里面有该事务id，那么该事务不会读取该版本的记录，而是沿着undo log链条往下找旧版本的记录，直到找到trx_id比事务b小的min_trx_id值的第一条记录</p><h2 id=读提交是如何工作的>读提交是如何工作的？</h2><p>读提交隔离事件在每次读取数据的时候，都会生成一个新的Read View</p></section></main><footer id=main-footer><div class=footer><a href=#>回到顶部 ↑</a><div class=footer-copyright><div>© 2025 Chen-Hang</div><div>powered by <a href=https://github.com/math-queiroz/rusty-typewriter target=_blank>Rusty Typewriter</a> theme for <a href=https://gohugo.io/ target=_blank>Hugo</a></div></div></div></footer></div><aside id=side-pane class=side-sticky><div class=side-details><span>1719 字数</span>
<span>5 - 7 阅读时间</span><div class=side-details-taxonomy><small>categories:
<span class=details-taxonomy><a href=https://chhz0.github.io/categories/note>Note</a></span></small></div></div><h3>目录</h3><nav id=TableOfContents><ul><li><a href=#1事务有哪些特征>1.事务有哪些特征</a></li><li><a href=#2并发事务会引发的问题>2.并发事务会引发的问题</a></li><li><a href=#3事务的隔离级别>3.事务的隔离级别</a></li><li><a href=#read-view在mvcc中是如何工作的>Read View在MVCC中是如何工作的？</a></li><li><a href=#可重复读是如何工作的>可重复读是如何工作的？</a></li><li><a href=#读提交是如何工作的>读提交是如何工作的？</a></li></ul></nav><h3>相关</h3><ul><li><a href=/notes/database/mysql/mysql-log/>Mysql Log(bate)</a></li><li><a href=/notes/database/mysql/mysql-lock/>Mysql Lock(bate)</a></li><li><a href=/notes/database/mysql/mysql-index/>Mysql Index(bate)</a></li><li><a href=/notes/database/mysql/mysql-buffer-pool/>Mysql Buffer Pool(bate)</a></li><li><a href=/notes/database/mysql/mysql-arch/>Mysql Arch(bate)</a></li></ul></aside></div></div></body></html>